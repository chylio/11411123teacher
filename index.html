<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¥‡ç¾æœˆâ”€æ•™å­¸å…±è­˜ç‡Ÿ å ±åè¡¨</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* è¨­ç½® Inter å­—é«”ç‚ºå„ªå…ˆï¼Œä¸¦è®“æ•´é«”æ’ç‰ˆæ›´èˆ’é© */
        body {
            font-family: 'Inter', sans-serif;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem 1rem;
        }
    </style>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'vibrant-purple': '#8B5CF6',
                        'vibrant-pink': '#EC4899',
                        'vibrant-yellow': '#FCD34D',
                    }
                }
            }
        }

        // <<< å·²æ›¿æ›ç‚ºæ‚¨æä¾›çš„ Google Apps Script ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ç¶²å€ >>>
        const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyVqT7XhAM9n4KItbOzZO6tyGeE1Spp8rnbZ22m_b1nTkxMEAbKM1M6Onc4Jk7Of-d1bg/exec'; 
        
        async function handleSubmit(event) {
            event.preventDefault();
            const form = event.target;
            const submitButton = document.getElementById('submitButton');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');

            // 1. æº–å‚™è¡¨å–®è³‡æ–™
            const formData = new FormData(form);
            // Apps Script åªéœ€è¦ URLSearchParams æ ¼å¼çš„æ•¸æ“š
            const data = new URLSearchParams(formData).toString(); 

            // 2. é¡¯ç¤ºåŠ è¼‰ç‹€æ…‹ä¸¦ç¦ç”¨æŒ‰éˆ•
            submitButton.textContent = 'è³‡æ–™å‚³é€ä¸­...';
            submitButton.disabled = true;
            submitButton.classList.remove('hover:bg-vibrant-purple');
            submitButton.classList.add('bg-gray-400', 'cursor-wait');
            
            // æ¸…é™¤ä¹‹å‰çš„è¨Šæ¯
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');


            if (APPS_SCRIPT_URL === 'YOUR_APPS_SCRIPT_WEB_APP_URL') {
                 // é€™æ˜¯éŒ¯èª¤ç¤ºç¯„ï¼Œé¿å…ä½¿ç”¨è€…å¿˜è¨˜æ›¿æ›ç¶²å€
                console.error("è«‹å…ˆå°‡ APPS_SCRIPT_URL æ›¿æ›ç‚ºæ‚¨çš„ Apps Script ç¶²è·¯æ‡‰ç”¨ç¨‹å¼ç¶²å€ï¼");
                errorMessage.querySelector('p:last-child').textContent = "è«‹å…ˆæ›¿æ› APPS_SCRIPT_URL è®Šæ•¸ï¼";
                errorMessage.classList.remove('hidden');
                
                // æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                submitButton.textContent = 'ç«‹å³å ±åï¼é»ç‡ƒæ‚¨çš„ç†±æƒ…';
                submitButton.disabled = false;
                submitButton.classList.remove('bg-gray-400', 'cursor-wait');
                submitButton.classList.add('hover:bg-vibrant-purple');
                return;
            }

            try {
                // 3. åŸ·è¡Œ POST è«‹æ±‚åˆ° Apps Script
                const response = await fetch(APPS_SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors', // å¿…é ˆä½¿ç”¨ no-cors æ¨¡å¼ä¾†é¿å…è·¨åŸŸå•é¡Œï¼ŒApps Script æœƒè™•ç†éŸ¿æ‡‰
                    headers: {
                        'Content-Type': 'application/x-www-form-urlencoded',
                    },
                    body: data
                });

                // ç”±æ–¼ä½¿ç”¨äº† 'no-cors'ï¼Œæˆ‘å€‘ç„¡æ³•ç›´æ¥æª¢æŸ¥éŸ¿æ‡‰çš„å…§å®¹æˆ–ç‹€æ…‹ç¢¼ï¼Œ
                // ä½†é€šå¸¸ Apps Script æ¥æ”¶åˆ°è«‹æ±‚å¾Œå°±æœƒæˆåŠŸå¯«å…¥ã€‚
                
                // å‡è¨­æˆåŠŸï¼ˆåœ¨ no-cors æ¨¡å¼ä¸‹ï¼Œé€™æ˜¯æœ€å¸¸è¦‹çš„è¡Œç‚ºï¼‰
                submitButton.textContent = 'å ±åæˆåŠŸï¼æ„Ÿè¬æ‚¨çš„åƒèˆ‡ï¼';
                submitButton.classList.remove('bg-vibrant-pink', 'bg-gray-400', 'cursor-wait');
                submitButton.classList.add('bg-green-500', 'cursor-not-allowed');
                successMessage.classList.remove('hidden');
                
                // æ¸…ç©ºè¡¨å–®
                form.reset();

            } catch (error) {
                // è™•ç†ç¶²çµ¡éŒ¯èª¤ï¼ˆä¾‹å¦‚ URL éŒ¯èª¤æˆ–ç„¡æ³•é€£æ¥ï¼‰
                console.error('æäº¤å ±åè³‡æ–™æ™‚ç™¼ç”ŸéŒ¯èª¤:', error);
                
                submitButton.textContent = 'å ±åå¤±æ•—ï¼Œè«‹é‡è©¦';
                submitButton.classList.remove('bg-gray-400', 'cursor-wait');
                submitButton.classList.add('bg-red-500', 'hover:bg-red-600');
                submitButton.disabled = false; // å…è¨±é‡è©¦

                errorMessage.querySelector('p:last-child').textContent = `ç¶²çµ¡éŒ¯èª¤: ${error.message}`;
                errorMessage.classList.remove('hidden');
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-vibrant-yellow via-vibrant-pink to-vibrant-purple text-gray-800">

    <div class="w-full max-w-4xl p-6 md:p-10 bg-white bg-opacity-95 rounded-3xl shadow-2xl backdrop-blur-sm transform transition duration-500 hover:scale-[1.01]">
        
        <!-- Header / Event Title -->
        <header class="text-center mb-10">
            <h1 class="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-vibrant-pink to-vibrant-purple mb-2">
                å¥‡ç¾æœˆâ”€æ•™å­¸å…±è­˜ç‡Ÿ
            </h1>
            <h2 class="text-xl md:text-2xl text-gray-600 font-medium">
                é»ç‡ƒæ•™å­¸ç†±æƒ…ï¼Œå…±å‰µé†«å­¸æ•™è‚²æ–°ç¯‡ç« ï¼
            </h2>
            <p class="mt-4 text-sm text-gray-500">
                ä¸»è¾¦å–®ä½ï¼š<strong class="text-vibrant-purple">å¥‡ç¾é†«é™¢æ•™å­¸éƒ¨</strong>
            </p>
        </header>

        <!-- Event Information Section -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-10 text-center">
            
            <div class="p-4 bg-vibrant-pink/10 rounded-xl shadow-md">
                <p class="text-lg font-semibold text-vibrant-pink">æ—¥æœŸ</p>
                <p class="text-xl font-bold mt-1">2025 å¹´ 11 æœˆ 23 æ—¥ (æ—¥)</p>
            </div>
            
            <div class="p-4 bg-vibrant-purple/10 rounded-xl shadow-md">
                <p class="text-lg font-semibold text-vibrant-purple">æ™‚é–“</p>
                <p class="text-xl font-bold mt-1">14:00 - 17:00 (å…± 3 å°æ™‚)</p>
            </div>
            
            <div class="p-4 bg-vibrant-yellow/10 rounded-xl shadow-md">
                <p class="text-lg font-semibold text-vibrant-yellow">åœ°é»</p>
                <p class="text-xl font-bold mt-1">å¥‡ç¾åšç‰©é¤¨è±æ”¶å»³</p>
            </div>
        </section>

        <!-- Agenda Section (Optional but informative) -->
        <section class="mb-10 p-6 bg-gray-50 rounded-2xl border border-gray-200">
            <h3 class="text-2xl font-bold mb-4 text-vibrant-purple border-b-2 border-vibrant-pink pb-2">æ´»å‹•è­°ç¨‹</h3>
            <ul class="space-y-3">
                <li class="flex items-start">
                    <span class="w-24 font-medium text-gray-700 flex-shrink-0">12:45-13:00</span>
                    <span class="ml-4 flex-grow">å ±åˆ°åŠå…¥å ´ <span class="text-xs text-gray-500">(è¨˜å¾—æ—©é»ä¾†å–”ï¼)</span></span>
                </li>
                <li class="flex items-start">
                    <span class="w-24 font-medium text-gray-700 flex-shrink-0">13:00-13:10</span>
                    <span class="ml-4 flex-grow">é•·å®˜è‡´è©</span>
                </li>
                <li class="flex items-start">
                    <span class="w-24 font-medium text-gray-700 flex-shrink-0">13:10-13:25</span>
                    <span class="ml-4 flex-grow">é†«å­¸æ•™è‚²å‰ç»èˆ‡æœªä¾†</span>
                </li>
                <li class="flex items-start">
                    <span class="w-24 font-medium text-gray-700 flex-shrink-0">13:25-14:20</span>
                    <span class="ml-4 flex-grow">æ•™å­¸å‹ä¸»æ²»é†«å¸«æœªä¾†æ•™å­¸è¨ˆç•«å ±å‘Š</span>
                </li>
            </ul>
        </section>

        <!-- Registration Form Section -->
        <section>
            <h3 class="text-3xl font-bold text-vibrant-pink mb-6">
                åŸºæœ¬è³‡æ–™å¡«å¯«
            </h3>
            
            <!-- æ³¨æ„ï¼šform å…ƒç´ å°‡ä¸å†éœ€è¦ action/method å±¬æ€§ï¼Œå› ç‚ºæˆ‘å€‘ä½¿ç”¨ JavaScript fetch æäº¤ -->
            <form onsubmit="handleSubmit(event)" class="space-y-6">
                
                <!-- å§“å (Name) -->
                <div>
                    <label for="name" class="block text-sm font-medium text-gray-700 mb-1">å§“å</label>
                    <!-- name å±¬æ€§ç”¨æ–¼ Apps Script æ¥æ”¶è³‡æ–™ -->
                    <input type="text" id="name" name="name" required 
                           placeholder="è«‹è¼¸å…¥æ‚¨çš„å…¨å"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-vibrant-purple focus:border-vibrant-purple transition duration-150">
                </div>

                <!-- é›»å­éƒµä»¶ (Email) -->
                <div>
                    <label for="email" class="block text-sm font-medium text-gray-700 mb-1">é›»å­éƒµä»¶ (Email)</label>
                    <input type="email" id="email" name="email" required 
                           placeholder="è«‹è¼¸å…¥å¸¸ç”¨çš„é›»å­éƒµä»¶åœ°å€"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-vibrant-purple focus:border-vibrant-purple transition duration-150">
                </div>

                <!-- å–®ä½ (Unit/Department) -->
                <div>
                    <label for="unit" class="block text-sm font-medium text-gray-700 mb-1">å–®ä½</label>
                    <input type="text" id="unit" name="unit" required 
                           placeholder="ä¾‹å¦‚ï¼šå…§ç§‘éƒ¨ã€è­·ç†éƒ¨"
                           class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-vibrant-purple focus:border-vibrant-purple transition duration-150">
                </div>

                <!-- è·ç¨± (Title) -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">
                        è·ç¨± <span class="text-red-500">(å¿…å¡«)</span>
                    </label>
                    <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                        <!-- Radio buttons for job title selection -->
                        <label class="flex items-center p-3 bg-vibrant-purple/5 rounded-lg border border-vibrant-purple/30 cursor-pointer hover:bg-vibrant-purple/10 transition duration-150">
                            <input type="radio" name="title" value="é†«å¸«" required class="form-radio text-vibrant-purple h-5 w-5 mr-2">
                            <span class="text-sm font-medium text-gray-800">é†«å¸«</span>
                        </label>
                        <label class="flex items-center p-3 bg-vibrant-purple/5 rounded-lg border border-vibrant-purple/30 cursor-pointer hover:bg-vibrant-purple/10 transition duration-150">
                            <input type="radio" name="title" value="è­·ç†å¸«" class="form-radio text-vibrant-purple h-5 w-5 mr-2">
                            <span class="text-sm font-medium text-gray-800">è­·ç†å¸«</span>
                        </label>
                        <label class="flex items-center p-3 bg-vibrant-purple/5 rounded-lg border border-vibrant-purple/30 cursor-pointer hover:bg-vibrant-purple/10 transition duration-150">
                            <input type="radio" name="title" value="é†«äº‹äººå“¡" class="form-radio text-vibrant-purple h-5 w-5 mr-2">
                            <span class="text-sm font-medium text-gray-800">é†«äº‹äººå“¡</span>
                        </label>
                        <label class="flex items-center p-3 bg-vibrant-purple/5 rounded-lg border border-vibrant-purple/30 cursor-pointer hover:bg-vibrant-purple/10 transition duration-150">
                            <input type="radio" name="title" value="è¡Œæ”¿äººå“¡" class="form-radio text-vibrant-purple h-5 w-5 mr-2">
                            <span class="text-sm font-medium text-gray-800">è¡Œæ”¿äººå“¡</span>
                        </label>
                        <label class="flex items-center p-3 bg-vibrant-purple/5 rounded-lg border border-vibrant-purple/30 cursor-pointer hover:bg-vibrant-purple/10 transition duration-150">
                            <input type="radio" name="title" value="å…¶ä»–" class="form-radio text-vibrant-purple h-5 w-5 mr-2">
                            <span class="text-sm font-medium text-gray-800">å…¶ä»–</span>
                        </label>
                    </div>
                </div>

                <!-- Submit Button -->
                <button type="submit" id="submitButton"
                        class="w-full py-4 text-xl font-bold text-white bg-vibrant-pink rounded-xl shadow-lg transition duration-300 transform hover:scale-[1.02] hover:bg-vibrant-purple focus:outline-none focus:ring-4 focus:ring-vibrant-pink/50 active:scale-100">
                    ç«‹å³å ±åï¼é»ç‡ƒæ‚¨çš„ç†±æƒ…
                </button>
            </form>
            
            <!-- Success Message -->
            <div id="successMessage" class="hidden mt-6 p-4 bg-green-100 border-l-4 border-green-500 text-green-700 rounded-lg" role="alert">
                <p class="font-bold">ğŸ‰ å ±åè¡¨å–®å·²é€å‡ºï¼</p>
                <p>è³‡æ–™å·²æˆåŠŸå¯«å…¥ Google Sheetsã€‚æ„Ÿè¬æ‚¨çš„å ±åï¼Œæˆ‘å€‘æœŸå¾…æ‚¨çš„åƒèˆ‡ã€‚</p>
            </div>
            
            <!-- Error Message -->
            <div id="errorMessage" class="hidden mt-6 p-4 bg-red-100 border-l-4 border-red-500 text-red-700 rounded-lg" role="alert">
                <p class="font-bold">âŒ å ±åå¤±æ•—ï¼</p>
                <p>è«‹æª¢æŸ¥æ‚¨çš„ç¶²è·¯æˆ– Apps Script ç¶²å€è¨­å®šã€‚</p>
            </div>

            <!-- Disclaimer -->
            <p class="mt-8 text-center text-xs text-gray-500">
                æœ¬å ±åè³‡æ–™åƒ…ä¾›æœ¬æ¬¡ç ”è¨æœƒè¯ç¹«èˆ‡é¤é»çµ±è¨ˆä½¿ç”¨ã€‚
            </p>

            <!-- NEW: Dashboard Link for Admin/Management -->
            <div class="text-center mt-4">
                <a href="./dashboard.html" class="text-sm font-medium text-vibrant-purple hover:text-vibrant-pink transition duration-150">
                    æŸ¥çœ‹å ±åç¾æ³å„€è¡¨æ¿ (ç®¡ç†å“¡å…¥å£)
                </a>
            </div>
            
        </section>

    </div>

</body>
</html>
